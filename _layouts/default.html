<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% if page.title %}{{ page.title }} | {{ site.title }}{% else %}{{ site.title }}{% endif %}</title>
    <meta name="description" content="{{ page.excerpt | default: site.description | strip_html | strip_newlines | truncate: 160 }}">
    <style>
      html { background: #f4f0e8; }
      html[data-theme="dark"] { background: #1f1f1f; }
    </style>
    <script>
      (function() {
        var savedTheme = localStorage.getItem("theme");
        var prefersDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
        var initialTheme = savedTheme || (prefersDark ? "dark" : "light");
        document.documentElement.setAttribute("data-theme", initialTheme);
      })();
    </script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@500;600;700&family=Source+Sans+3:wght@400;500;600&display=swap");

      :root {
        color-scheme: light;
        --bg: #f4f0e8;
        --bg-top: #ece4d7;
        --surface: #fbf8f2;
        --text: #2a2620;
        --muted: #7f7669;
        --brand: #c26d3a;
        --brand-soft: #f0dfce;
        --border: color-mix(in srgb, #d9cdbd 72%, transparent);
        --shadow: rgba(56, 43, 31, 0.09);
        --btn-bg: #c26d3a;
        --btn-text: #fff7ed;
        --radius: 12px;
      }

      :root[data-theme="dark"] {
        color-scheme: dark;
        --bg: #1f1f1f;
        --bg-top: #242424;
        --surface: #2b2b2b;
        --text: #ddd8cf;
        --muted: #9f9789;
        --brand: #e08a52;
        --brand-soft: #3a332d;
        --border: color-mix(in srgb, #453e37 78%, transparent);
        --shadow: rgba(0, 0, 0, 0.34);
        --btn-bg: #e08a52;
        --btn-text: #2a1d14;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Source Sans 3", "Segoe UI", sans-serif;
        background:
          radial-gradient(circle at 0% 0%, color-mix(in srgb, var(--brand-soft) 40%, transparent), transparent 45%),
          linear-gradient(180deg, var(--bg-top) 0%, var(--bg) 55%);
        color: var(--text);
        line-height: 1.72;
        opacity: 0;
        animation: page-fade 220ms ease forwards;
        transition: background 180ms ease, color 180ms ease;
      }

      body.page-leaving {
        opacity: 0.35;
        transition: opacity 120ms ease;
      }

      @keyframes page-fade {
        to {
          opacity: 1;
        }
      }

      .site {
        max-width: 984px;
        margin: 0 auto;
        padding: 1rem;
      }

      .card {
        background: color-mix(in srgb, var(--surface) 96%, var(--bg));
        border: 1px solid var(--border);
        border-radius: var(--radius);
        box-shadow: 0 8px 18px var(--shadow), inset 0 1px 0 color-mix(in srgb, var(--surface) 88%, #fff 12%);
        transition: transform 180ms ease, border-color 180ms ease, box-shadow 180ms ease, background 180ms ease;
      }

      .header-card {
        position: relative;
        overflow: visible;
      }

      .nav {
        position: relative;
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 0.75rem;
        margin-bottom: 0;
        padding-right: 8rem;
      }

      .nav a {
        text-decoration: none;
        color: var(--muted);
        font-weight: 600;
        padding: 0.45rem 0.75rem;
        border-radius: 8px;
      }

      .nav span {
        color: var(--muted);
        font-weight: 600;
        padding: 0.45rem 0.75rem;
        border-radius: 8px;
      }

      a,
      a:visited {
        color: var(--brand);
      }

      .nav a.active,
      .nav span.active,
      .nav a:hover {
        color: var(--brand);
        background: color-mix(in srgb, var(--brand-soft) 82%, transparent);
      }

      .theme-switch {
        position: absolute;
        top: 0.75rem;
        right: 0.75rem;
        display: flex;
        align-items: center;
      }

      .theme-toggle {
        appearance: none;
        width: 48px;
        height: 28px;
        border-radius: 999px;
        border: 1px solid var(--border);
        background: var(--brand-soft);
        position: relative;
        cursor: pointer;
        transition: background 0.2s ease, border-color 0.2s ease;
        overflow: hidden;
      }

      .theme-toggle::before {
        content: "☾";
        position: absolute;
        top: 50%;
        right: 7px;
        transform: translateY(-50%);
        font-size: 12px;
        color: var(--muted);
        opacity: 0.9;
        transition: opacity 0.2s ease;
      }

      .theme-toggle::after {
        content: "";
        position: absolute;
        top: 2px;
        left: 2px;
        width: 22px;
        height: 22px;
        border-radius: 50%;
        background: var(--surface);
        border: 1px solid var(--border);
        transition: transform 0.2s ease;
      }

      :root[data-theme="dark"] .theme-toggle::after {
        transform: translateX(20px);
      }

      :root[data-theme="dark"] .theme-toggle::before {
        content: "☀";
        right: auto;
        left: 7px;
        color: #fbbf24;
        opacity: 0.95;
      }

      .theme-toggle:hover {
        border-color: var(--brand);
      }

      .theme-toggle:focus-visible {
        outline: 2px solid var(--brand);
        outline-offset: 2px;
      }

      .content {
        padding: 1.35rem;
      }

      h1,
      h2,
      h3,
      .post-title {
        font-family: "JetBrains Mono", "Menlo", "Consolas", monospace;
        line-height: 1.24;
        margin: 0 0 0.75rem;
      }

      .section-title {
        position: relative;
        padding-bottom: 0.4rem;
        margin-bottom: 1rem;
      }

      .section-title::after {
        content: "";
        display: block;
        width: 56px;
        height: 2px;
        margin-top: 0.45rem;
        background: linear-gradient(90deg, var(--brand), color-mix(in srgb, var(--brand) 45%, transparent));
      }

      .muted {
        color: var(--muted);
      }

      .tagline {
        margin: 0 0 0.45rem;
        font-size: 0.95rem;
        color: var(--muted);
      }

      .welcome-head {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .welcome-avatar {
        width: 112px;
        height: 112px;
        border-radius: 50%;
        overflow: hidden;
        flex-shrink: 0;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border: 2px solid var(--border);
        background: color-mix(in srgb, var(--surface) 75%, var(--brand-soft));
        box-shadow: 0 8px 18px var(--shadow);
      }

      .welcome-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }

      .welcome-avatar .avatar-fallback {
        display: none;
        font-family: "JetBrains Mono", "Menlo", "Consolas", monospace;
        font-weight: 700;
        font-size: 1rem;
        color: var(--muted);
      }

      .welcome-avatar.no-image img {
        display: none;
      }

      .welcome-avatar.no-image .avatar-fallback {
        display: inline-flex;
      }

      .section-divider {
        border: 0;
        border-top: 1px solid var(--border);
        margin: 1.2rem 0 1.1rem;
      }

      .post-list {
        display: grid;
        gap: 1rem;
      }

      .post-item {
        padding: 1rem;
      }

      .post-card:hover {
        transform: translateY(-2px);
        border-color: color-mix(in srgb, var(--brand) 42%, var(--border));
        box-shadow: 0 12px 24px var(--shadow), 0 0 0 1px color-mix(in srgb, var(--brand) 18%, transparent);
      }

      .post-title {
        font-size: 1.06rem;
        font-weight: 600;
        margin-bottom: 0.45rem;
      }

      .meta {
        font-size: 0.79rem;
        color: color-mix(in srgb, var(--muted) 82%, transparent);
        margin: 0.35rem 0 0.65rem;
      }

      .post-preview {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
        margin: 0;
      }

      .post-article {
        max-width: 780px;
        margin: 0 auto;
      }

      .post-header {
        margin-bottom: 1.35rem;
      }

      .post-content p,
      .post-content ul,
      .post-content ol,
      .post-content pre,
      .post-content blockquote,
      .post-content h2,
      .post-content h3 {
        margin: 0 0 1.05rem;
      }

      .post-content pre,
      .post-content code {
        font-family: "JetBrains Mono", "Menlo", "Consolas", monospace;
      }

      .post-content pre {
        background: color-mix(in srgb, var(--surface) 82%, #111 18%);
        border: 1px solid var(--border);
        border-radius: 10px;
        padding: 0.8rem;
        overflow-x: auto;
      }

      .post-content blockquote {
        margin-left: 0;
        padding-left: 0.85rem;
        border-left: 3px solid color-mix(in srgb, var(--brand) 68%, transparent);
        color: var(--muted);
      }

      .btn {
        display: inline-block;
        text-decoration: none;
        background: var(--btn-bg);
        color: var(--btn-text);
        padding: 0.45rem 0.8rem;
        border-radius: 8px;
        font-weight: 600;
      }

      .btn:visited {
        color: var(--btn-text);
      }

      footer {
        text-align: center;
        color: var(--muted);
        font-size: 0.9rem;
        padding: 1.25rem 0;
      }

      .footer-note {
        margin: 0 0 0.7rem;
        font-size: 0.86rem;
      }

      .socials {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 0.65rem;
        margin-bottom: 0.75rem;
      }

      .social-link {
        width: 44px;
        height: 44px;
        border-radius: 50%;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: color-mix(in srgb, var(--surface) 72%, var(--brand-soft));
        border: 1px solid var(--border);
        color: var(--muted);
        text-decoration: none;
        box-shadow: 0 6px 14px var(--shadow);
        transition: border-color 0.18s ease, transform 0.18s ease;
      }

      .social-link:visited {
        color: var(--muted);
      }

      .social-link:hover {
        border-color: var(--brand);
        transform: translateY(-1px);
      }

      .social-link svg {
        width: 20px;
        height: 20px;
        fill: currentColor;
      }

      @media (max-width: 640px) {
        .site {
          padding: 0.75rem;
        }

        .nav {
          padding-right: 7rem;
          gap: 0.5rem;
        }

        .content {
          padding: 1rem;
        }

        .welcome-head {
          align-items: flex-start;
          gap: 0.75rem;
        }

        .welcome-avatar {
          width: 74px;
          height: 74px;
          border-width: 1px;
        }
      }
    </style>
  </head>
  <body>
    <div class="site">
      <header class="card header-card">
        {% include navigation.html %}
        <div class="theme-switch">
          <input id="theme-toggle" class="theme-toggle" type="checkbox" role="switch" aria-label="Toggle light and dark mode">
        </div>
      </header>
      <main class="card content">
        {{ content }}
      </main>
      <footer>
        <p class="footer-note">Thoughts on DFIR, tooling, and investigations.</p>
        <div class="socials" aria-label="Social links">
          <a class="social-link" href="{{ site.social_github | default: '#' }}" aria-label="GitHub">
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 .5a12 12 0 0 0-3.79 23.39c.6.11.82-.26.82-.58v-2.04c-3.34.73-4.04-1.42-4.04-1.42-.55-1.38-1.33-1.74-1.33-1.74-1.09-.74.08-.73.08-.73 1.2.08 1.84 1.24 1.84 1.24 1.08 1.84 2.82 1.31 3.5 1 .1-.77.42-1.31.76-1.61-2.67-.31-5.47-1.35-5.47-5.98 0-1.32.47-2.39 1.24-3.23-.12-.31-.54-1.56.12-3.26 0 0 1.01-.33 3.3 1.23a11.4 11.4 0 0 1 6 0c2.28-1.56 3.29-1.23 3.29-1.23.66 1.7.24 2.95.12 3.26.77.84 1.24 1.91 1.24 3.23 0 4.64-2.8 5.67-5.48 5.97.43.37.81 1.1.81 2.22v3.29c0 .32.22.7.83.58A12 12 0 0 0 12 .5Z"/></svg>
          </a>
          <a class="social-link" href="{{ site.social_x | default: '#' }}" aria-label="X">
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M18.24 2H21l-6.57 7.5L22 22h-6.14l-4.8-6.29L5.5 22H2.74l7.04-8.04L2.5 2h6.3l4.34 5.73L18.24 2Zm-1.08 18h1.7L7.86 3.9H6.03L17.16 20Z"/></svg>
          </a>
          <a class="social-link" href="mailto:{{ site.email | default: 'your-email@example.com' }}" aria-label="Email">
            <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 5h18a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2Zm0 2v.2L12 13l9-5.8V7H3Zm18 10V9.5l-8.46 5.43a1 1 0 0 1-1.08 0L3 9.5V17h18Z"/></svg>
          </a>
        </div>
        &copy; {{ "now" | date: "%Y" }} {{ site.title }}
      </footer>
    </div>
    <script>
      (function() {
        var root = document.documentElement;
        var themeToggle = document.getElementById("theme-toggle");

        function currentTheme() {
          return root.getAttribute("data-theme") || "light";
        }

        function setTheme(theme) {
          root.setAttribute("data-theme", theme);
          localStorage.setItem("theme", theme);
          themeToggle.checked = theme === "dark";
        }

        themeToggle.addEventListener("change", function() {
          setTheme(themeToggle.checked ? "dark" : "light");
        });

        document.addEventListener("click", function(event) {
          var link = event.target.closest("a");
          if (!link) return;
          var href = link.getAttribute("href");
          if (!href) return;
          if (link.target === "_blank" || href.startsWith("#") || href.startsWith("mailto:")) return;
          if (link.origin !== window.location.origin) return;
          document.body.classList.add("page-leaving");
        });

        setTheme(currentTheme());
      })();
    </script>
  </body>
</html>
